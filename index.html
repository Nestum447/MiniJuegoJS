<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mini Juego con Joystick Virtual</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    body { 
      margin: 0; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      background: black;
      touch-action: manipulation;
      overscroll-behavior: contain;
      user-select: none;
    }
    canvas { background: #111; margin-top: 10px; }
    /* Joystick */
    #joystick {
      position: fixed;
      bottom: 30px;
      left: 30px;
      width: 120px;
      height: 120px;
      background: rgba(200, 200, 200, 0.2);
      border-radius: 50%;
      touch-action: none;
    }
    #stick {
      position: absolute;
      left: 35px;
      top: 35px;
      width: 50px;
      height: 50px;
      background: rgba(0, 0, 255, 0.7);
      border-radius: 50%;
    }
  </style>
</head>
<body>
  <h2 style="color:white;">ðŸŽ® Mini Juego con Joystick</h2>
  <canvas id="gameCanvas" width="500" height="500"></canvas>

  <!-- Joystick Virtual -->
  <div id="joystick">
    <div id="stick"></div>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const jugador = { x: 200, y: 200, size: 50, velocidad: 3 };

    // Variables joystick
    const joystick = document.getElementById("joystick");
    const stick = document.getElementById("stick");
    const center = { x: 60, y: 60 }; // centro del joystick
    let dragging = false;
    let dirX = 0, dirY = 0;

    // Eventos tÃ¡ctiles
    joystick.addEventListener("touchstart", (e) => {
      dragging = true;
      moverStick(e.touches[0]);
    });

    joystick.addEventListener("touchmove", (e) => {
      if (dragging) moverStick(e.touches[0]);
    });

    joystick.addEventListener("touchend", () => {
      dragging = false;
      dirX = 0; dirY = 0;
      stick.style.left = "35px";
      stick.style.top = "35px";
    });

    function moverStick(touch) {
      const rect = joystick.getBoundingClientRect();
      const x = touch.clientX - rect.left;
      const y = touch.clientY - rect.top;

      // Vector desde el centro
      let dx = x - center.x;
      let dy = y - center.y;
      const distancia = Math.sqrt(dx*dx + dy*dy);

      // Normalizar movimiento
      if (distancia > 40) {
        dx = (dx / distancia) * 40;
        dy = (dy / distancia) * 40;
      }

      stick.style.left = (center.x - 25 + dx) + "px";
      stick.style.top = (center.y - 25 + dy) + "px";

      dirX = dx / 40;
      dirY = dy / 40;
    }

    // Game loop
    function gameLoop() {
      jugador.x += dirX * jugador.velocidad;
      jugador.y += dirY * jugador.velocidad;

      // LÃ­mites
      if (jugador.x < 0) jugador.x = 0;
      if (jugador.x > canvas.width - jugador.size) jugador.x = canvas.width - jugador.size;
      if (jugador.y < 0) jugador.y = 0;
      if (jugador.y > canvas.height - jugador.size) jugador.y = canvas.height - jugador.size;

      // Dibujar
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "blue";
      ctx.fillRect(jugador.x, jugador.y, jugador.size, jugador.size);

      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
